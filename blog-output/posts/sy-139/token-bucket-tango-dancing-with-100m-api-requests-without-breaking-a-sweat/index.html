<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Token Bucket Tango - Dancing With 100M API Requests Without Breaking a Sweat | DevInsights</title>
  <meta name="description" content="Build a distributed token bucket rate limiter handling 100M+ daily API calls across 5 regions with sub-50ms latency using Redis Cluster and multi-tenant isolation.">
  <meta name="theme-color" content="#050505">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
  <script>mermaid.initialize({startOnLoad:true,theme:'dark',themeVariables:{primaryColor:'#7c3aed',primaryTextColor:'#fafafa',primaryBorderColor:'rgba(255,255,255,0.1)',lineColor:'#00d4ff',secondaryColor:'#111',tertiaryColor:'#161616'}});</script>
  <link rel="stylesheet" href="/style.css">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>‚óÜ</text></svg>">
</head>
<body>
<style>
.related-articles { margin-top: 3rem; padding-top: 2rem; border-top: 1px solid var(--border); }
.related-articles h3 { font-size: 1rem; margin-bottom: 1rem; color: var(--text); }
.related-grid { display: grid; gap: 0.75rem; }
.related-card { display: flex; justify-content: space-between; align-items: center; padding: 1rem; background: var(--bg-card); border: 1px solid var(--border); border-radius: var(--radius-sm); text-decoration: none; transition: all 0.2s; }
.related-card:hover { border-color: var(--border-hover); transform: translateX(4px); }
.related-title { color: var(--text); font-size: 0.875rem; font-weight: 500; }
.related-meta { color: var(--text-muted); font-size: 0.75rem; text-transform: capitalize; }
</style>
<header><div class="container header-content">
    <a href="/" class="logo">DevInsights</a>
    <nav>
      <a href="/">Home</a>
      <a href="/categories/">Topics</a>
      <button class="search-btn" onclick="openSearch()"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>Search<kbd>‚åòK</kbd></button>
      <a href="https://open-interview.github.io" target="_blank" class="nav-cta">Practice ‚Üí</a>
    </nav>
  </div></header>
<main><article class="article"><div class="container">
  <a href="/categories/system-design/" style="color:var(--text-muted);text-decoration:none;font-size:0.8125rem;display:inline-flex;align-items:center;gap:0.25rem;margin-bottom:2rem">‚Üê System Design</a>
  <div class="article-header">
    <h1>Token Bucket Tango - Dancing With 100M API Requests Without Breaking a Sweat</h1>
    <div class="article-meta" style="justify-content:flex-start;margin-top:1rem"><span class="tag">System Design</span><span class="difficulty advanced">advanced</span><span class="tag">api</span> <span class="tag">rest</span></div>
  </div>
  <p class="article-intro">Ever had your API crash at 3am because a 'small' client decided to test your limits with 50K requests per second? We've all been there - staring at error logs while the business team panics about lost revenue. Rate limiting isn't just about preventing abuse; it's about being a good host at a party where some guests just can't control themselves.</p>
  <div class="article-content">
    <h2>Why Your Naive Rate Limiter Is a Time Bomb</h2>Let's be honest - most of us start with the simplest approach: a fixed window counter in memory. It works... until it doesn't. Here's why that approach is basically playing Russian roulette with your infrastructure:</p><p>‚ö†Ô∏è <strong>Gotcha</strong>: Fixed windows create thundering herd problems. Everyone resets at the same time, causing massive spikes right after the window boundary.</p><p>üí° <strong>Pro Tip</strong>: The <span class="glossary-term" data-tooltip="Rate limiting approach that uses tokens refilling at a fixed rate, allowing bursts up to bucket capacity.">token bucket algorithm</span> is like having a bouncer who lets people in gradually, rather than slamming the door shut every minute.</p><p><strong>Comparison of Rate Limiting Approaches:</strong></p><p><table><thead><tr><th>Approach</th><th>Latency</th><th>Memory</th><th>Burst Handling</th><th>Complexity</th></tr></thead><tbody><tr><td>Fixed Window</td><td>5ms</td><td>Low</td><td>Poor</td><td>Low</td></tr><tr><td>Sliding Window</td><td>15ms</td><td>High</td><td>Good</td><td>Medium</td></tr><tr><td>Token Bucket</td><td>8ms</td><td>Medium</td><td>Excellent</td><td>Medium</td></tr><tr><td>Distributed Token Bucket</td><td>25ms</td><td>High</td><td>Excellent</td><td>High</td></tr></tbody></table><h2>The Distributed Token Bucket Magic</h2>Here's where things get interesting. We're not just counting tokens anymore - we're orchestrating a symphony across multiple regions. Think of it as having multiple bouncers who all know the same guest list.</p><p>üî• <strong>Hot Take</strong>: Redis Lua scripts are basically database stored procedures, but actually cool and useful.</p><p><strong>Core Architecture Components:</strong>
<ul><li>Redis Cluster (6 masters + 6 replicas) for distributed state</li>
<li>Local cache (Caffeine) for sub-10ms reads</li>
<li><span class="glossary-term" data-tooltip="Design pattern that prevents cascading failures by stopping requests to failing services.">Circuit breaker pattern</span> for resilience</li>
<li>Multi-region geo-routing</li>
<li>Real-time monitoring with Prometheus</li></ul>
<strong>The Atomic Lua Script That Saves Your Sanity:</strong>
<pre><code class="language-lua">local key = KEYS[1]
local capacity = tonumber(ARGV[1])
local tokens = tonumber(ARGV[2])
local interval = tonumber(ARGV[3])
local now = tonumber(ARGV[4])

local bucket = redis.call('HMGET', key, 'tokens', 'last_refill')
local current_tokens = tonumber(bucket[1]) or capacity
local last_refill = tonumber(bucket[2]) or now

local elapsed = now - last_refill
local tokens_to_add = math.floor(elapsed / interval) * tokens
current_tokens = math.min(capacity, current_tokens + tokens_to_add)

if current_tokens &gt;= 1 then
  redis.call('HMSET', key, 'tokens', current_tokens - 1, 'last_refill', now)
  redis.call('EXPIRE', key, 3600)
  return {1, current_tokens - 1}
else
  redis.call('HMSET', key, 'tokens', current_tokens, 'last_refill', now)
  redis.call('EXPIRE', key, 3600)
  return {0, current_tokens}
end</code></pre></p><p>üéØ <strong>Key Insight</strong>: The atomic nature of Lua scripts prevents race conditions that would otherwise allow users to exceed their limits.<h2>Multi-Tenant Madness - When Everyone Wants the VIP Treatment</h2>Managing rate limits for multiple tenants is like being a restaurant host who needs to remember everyone's dietary restrictions, preferred seating, and how much they've had to drink. Here's our tenant configuration model:</p><p><pre><code class="language-typescript">interface TenantConfig {
  tenantId: string;
  tier: 'basic' | 'premium' | 'enterprise';
  sustainedRate: number;
  burstRate: number;
  algorithm: 'token-bucket' | 'fixed-window';
  customRules?: Rule[];
}</code></pre></p><p><strong>Tier Configuration (Real Numbers):</strong>
<ul><li><strong>Basic</strong>: 1,000 RPS sustained, 3,000 RPS burst</li>
<li><strong>Premium</strong>: 10,000 RPS sustained, 30,000 RPS burst  </li>
<li><strong>Enterprise</strong>: 100,000 RPS sustained, 300,000 RPS burst</li></ul>
‚ö†Ô∏è <strong>Gotcha</strong>: Hot tenants can monopolize your Redis cluster. We learned this the hard way when one enterprise client decided to stress-test their integration over a holiday weekend.</p><p><strong>Capacity Planning Math That Actually Matters:</strong>
<pre><code>Redis Memory: 100K tenants √ó 64B state = 6.4MB
Local Cache: 10K active tenants √ó 64B = 640KB
Network: 100M calls √ó 200B = 20GB/day</code></pre></p><p>üí° <strong>Pro Tip</strong>: Implement hot tenant detection and dynamic cache warming. Monitor tenants exceeding 80% capacity and pre-warm their cache entries.<h2>When Things Go Wrong - The Art of Graceful Degradation</h2>Murphy's Law applies doubly to distributed systems. Here's how we handle the inevitable disasters:</p><p><strong>Clock Skew Mitigation:</strong>
<ul><li>Use Redis time instead of client time</li>
<li>Max skew tolerance: ¬±5 seconds</li>
<li>Fallback to last known good timestamp</li></p><p><strong>Network Partition Recovery:</strong>
<li>Stale data detection with version vectors</li>
<li>Graceful degradation to local-only mode</li>
<li>Automatic resync on reconnection</li></p><p><strong>Circuit Breaker Configuration:</strong>
<li>Timeout: 30 seconds</li>
<li>Error threshold: 50%</li>
<li>Half-open requests: 3 per second</li></ul>
üî• <strong>Hot Take</strong>: Sometimes the best rate limiter is no rate limiter. During major outages, we temporarily lift all restrictions and rely on our infrastructure's natural limits.<h2>Monitoring - Because You Can't Improve What You Can't Measure</h2>If you're not measuring it, you're flying blind. Here are the metrics that actually matter:</p><p><strong>Key Prometheus Metrics:</strong>
<pre><code class="language-prometheus"># Request metrics
rate_limit_requests_total{tenant, result=&quot;allowed|denied&quot;}
rate_limit_latency_seconds{tenant, region}

# System metrics  
redis_memory_usage_bytes
redis_connections_active
local_cache_hit_ratio

# Business metrics
tenant_rate_limit_utilization{tenant}
burst_capacity_usage{tenant}</code></pre></p><p><strong>Alerting Rules That Wake You Up (But Not Too Often):</strong>
<ul><li>P99 latency > 100ms for 5 minutes</li>
<li>Redis memory > 80% for 10 minutes</li>
<li>Cache hit ratio < 90% for 15 minutes</li>
<li>Tenant denial rate > 10% for 5 minutes</li></ul>
üéØ <strong>Key Insight</strong>: Monitor the rate of rate limit denials, not just the absolute numbers. A sudden spike in denials often indicates a misconfigured client or abuse.
    <div class="real-world-example">
      <h3>üè¢ Real-World Case Study</h3>
      <div class="company">Stripe</div>
      <p class="scenario">Stripe handles over 1 billion API requests daily with their rate limiting system. They use a sophisticated multi-tier approach with per-customer rate limits that adapt based on usage patterns and account status. Their system includes burst capacity for legitimate traffic spikes while protecting against abuse.</p>
      <div class="lesson"><strong>Key Takeaway:</strong> The key insight from Stripe's approach is that rate limiting should be dynamic, not static. They adjust limits based on customer tier, historical usage patterns, and real-time system load. This allows them to maximize throughput while maintaining stability.</div>
    </div><h2>System Flow</h2><div class="mermaid">graph TB
    Client[Client Request] --> LB[Load Balancer]
    LB --> RL[Rate Limiter Service]
    RL --> LC{Local Cache Check}
    LC -->|Hit| Allow[Allow Request]
    LC -->|Miss| Redis[Redis Cluster]
    Redis --> Script[Lua Token Bucket]
    Script --> Result{Result}
    Result -->|Allowed| Allow
    Result -->|Denied| Deny[Deny Request]
    RL --> CB[Circuit Breaker]
    CB -->|Redis Down| Fallback[Local Fallback Mode]
    RL --> Monitor[Prometheus Monitoring]
    Monitor --> Alert[Alerting System]
    Config[Config Service] --> RL
    TenantDB[Tenant Database] --> Config</div><div class="fun-fact"><span class="fun-fact-icon">üí°</span><p><strong>Did you know?</strong> The token bucket algorithm was originally invented in the 1980s for network traffic management in ATM (Asynchronous Transfer Mode) networks. It's older than many of the developers using it today!</p></div><div class="quick-ref"><h3>üìå Key Takeaways</h3><ul><li>Use Redis Lua scripts for atomic token bucket operations</li><li>Implement local cache fallback for sub-10ms latency</li><li>Monitor denial rates, not just absolute numbers</li><li>Design for graceful degradation during outages</li></ul></div><div class="sources"><h3>Further Reading</h3><ul><li><a href="https://redis.io/docs/manual/programmability/" target="_blank" rel="noopener">Redis Lua Scripting Documentation</a><span class="source-type">documentation</span></li><li><a href="https://stripe.com/blog/rate-limiters" target="_blank" rel="noopener">Stripe Engineering - Rate Limiting at Scale</a><span class="source-type">blog</span></li><li><a href="https://netflixtechblog.com/rate-limiting-at-netflix-7c8a9c0b1f7a" target="_blank" rel="noopener">Netflix Rate Limiting Architecture</a><span class="source-type">blog</span></li><li><a href="https://www.cs.ucdavis.edu/~vemuri/classes/ecs251/papers/token-bucket.pdf" target="_blank" rel="noopener">Token Bucket Algorithm Research Paper</a><span class="source-type">paper</span></li></ul></div>
    <h2>Wrapping Up</h2>
    <p>Ready to implement your own distributed rate limiter? Start with a simple Redis-based token bucket, add local caching for performance, and gradually enhance with multi-region support and monitoring. Remember: the perfect rate limiter is the one that actually gets deployed and saves you from that 3am panic call. Test with realistic load patterns, monitor your denial rates, and always have a fallback plan. Your future self (and your on-call rotation) will thank you.</p>
  </div>
  
    <div class="related-articles">
      <h3>Continue Reading</h3>
      <div class="related-grid">
        
          <a href="/posts/sy-132/rate-limiting-roulette-how-to-win-at-1m-requests-without-crashing/" class="related-card">
            <span class="related-title">Rate Limiting Roulette: How to Win at 1M+ Requests Without Crashing</span>
            <span class="related-meta">advanced</span>
          </a>
        
          <a href="/posts/sd-2/the-ring-master-how-netflix-survives-the-midnight-cache-apocalypse/" class="related-card">
            <span class="related-title">The Ring Master: How Netflix Survives the Midnight Cache Apocalypse</span>
            <span class="related-meta">advanced</span>
          </a>
        
          <a href="/posts/q-313/building-slacks-brain-how-real-time-chat-survives-the-chaos/" class="related-card">
            <span class="related-title">Building Slack's Brain: How Real-Time Chat Survives the Chaos</span>
            <span class="related-meta">advanced</span>
          </a>
        
      </div>
    </div>
  <div class="cta-box">
    <p>Ready to put this into practice?</p>
    <a href="https://open-interview.github.io/channel/system-design" class="cta-button">Practice Questions ‚Üí</a>
  </div>
</div></article></main>

<!-- Search Modal -->
<div class="search-modal" id="searchModal" onclick="if(event.target===this)closeSearch()">
  <div class="search-box">
    <div class="search-input-wrap">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
      <input type="text" class="search-input" id="searchInput" placeholder="Search articles..." autocomplete="off">
      <button class="search-close" onclick="closeSearch()">‚úï</button>
    </div>
    <div class="search-results" id="searchResults"></div>
  </div>
</div>

<footer><div class="container">
  <div class="footer-content">
    <div class="footer-brand">DevInsights</div>
    <div class="footer-links">
      <a href="/">Home</a>
      <a href="/categories/">Topics</a>
      <a href="https://open-interview.github.io" target="_blank">Practice</a>
    </div>
  </div>
  <div class="footer-copy">
    <p>¬© 2025 DevInsights ¬∑ Built for developers who ship ¬∑ <a href="https://open-interview.github.io">Reel Interview</a></p>
  </div>
</div></footer>

<script>
const searchData = [{"id":"q-281","slug":"the-art-of-technical-influence-how-i-won-battles-without-authority","title":"The Art of Technical Influence: How I Won Battles Without Authority","intro":"Picture this: You're in a meeting with senior engineers and managers, and you know the proposed solution is wrong. But you're not the tech lead, you d","channel":"engineering-management","difficulty":"intermediate","tags":["communication","collaboration","influence"]},{"id":"blog-1766680384332-d5ry73","slug":"database-types-compared-choose-the-right-one","title":"Database Types Compared: Choose the Right One","intro":"Picture this: You're building a new application and suddenly face the critical question - which database should you use? The wrong choice could lead t","channel":"database","difficulty":"intermediate","tags":["databases","sql","nosql","data-storage","architecture"]},{"id":"blog-1766676477930-9i8oki","slug":"docker-containers-revolutionize-your-development-workflow","title":"Docker Containers: Revolutionize Your Development Workflow","intro":"Picture this: You've spent weeks perfecting your web application on your laptop. Everything works flawlessly - the database connects, APIs respond, an","channel":"devops","difficulty":"beginner","tags":["docker","containers","devops","virtualization","microservices"]},{"id":"blog-1766675309405-7p8k4s","slug":"api-rate-limiting-protect-your-services-from-ddos","title":"API Rate Limiting: Protect Your Services from DDoS","intro":"Picture this: Your startup just launched a killer feature, and suddenly your servers are melting. Not from legitimate traffic, but from a single user ","channel":"backend","difficulty":"intermediate","tags":["api","rate-limiting","backend","security","nodejs"]},{"id":"blog-1766674305590-ncl9qn","slug":"rest-vs-graphql-choose-the-right-api-for-your-app","title":"REST vs GraphQL: Choose the Right API for Your App","intro":"Picture this: You're building a mobile app that needs to display user profiles, their recent posts, and follower counts. With your first REST API call","channel":"backend","difficulty":"intermediate","tags":["API","REST","GraphQL","Backend","WebDevelopment"]},{"id":"q-196","slug":"the-3am-pager-how-i-learned-to-tame-1000-http-requests-without-breaking-the-bank","title":"The 3am Pager: How I Learned to Tame 1000 HTTP Requests Without Breaking the Bank","intro":"It was 3am when the pager went off. Our production API was getting hammered, and the monitoring dashboard looked like a heart attack. We had 1000 requ","channel":"python","difficulty":"intermediate","tags":["asyncio","aiohttp","concurrency"]},{"id":"q-322","slug":"the-night-ai-lied-to-a-ceo-how-we-tamed-hallucinating-models","title":"The Night AI Lied to a CEO: How We Tamed Hallucinating Models","intro":"It was 3am when the pager went off. A Fortune 500 CEO had just been told by our customer service AI that their premium subscription included features ","channel":"generative-ai","difficulty":"beginner","tags":["hallucination","faithfulness","relevance"]},{"id":"q-460","slug":"the-3am-pager-how-i-learned-to-stop-worrying-and-love-e2e-testing","title":"The 3am Pager: How I Learned to Stop Worrying and Love E2E Testing","intro":"It was 3am when the pager went off. The login form was broken in production, and our CEO had just tweeted about the new feature launch. As I stumbled ","channel":"e2e-testing","difficulty":"beginner","tags":["e2e-testing"]},{"id":"q-212","slug":"the-3am-api-war-how-i-stopped-frontend-and-backend-teams-from-burning-the-house-","title":"The 3am API War: How I Stopped Frontend and Backend Teams from Burning the House Down","intro":"Picture this: It's 2:47 AM, your phone buzzes with that dreaded Slack notification. The frontend team is threatening to block the release because the ","channel":"behavioral","difficulty":"beginner","tags":["situation","task","action","result"]},{"id":"q-419","slug":"the-3am-pager-that-taught-me-websockets-dont-work-offline","title":"The 3am Pager That Taught Me WebSockets Don't Work Offline","intro":"It was 3am when the pager went off. Our food delivery app was losing thousands of orders because users kept going into tunnels and elevators. Everyone","channel":"frontend","difficulty":"intermediate","tags":["dom","fetch","websocket","service-worker"]},{"id":"q-237","slug":"the-3am-pager-how-we-broke-the-internet-and-fixed-it","title":"The 3am Pager: How We Broke the Internet (and Fixed It)","intro":"It was 3am when the pager went off. Our new feature had just gone viral, and instead of celebrating, we were watching our systems crash in real-time. ","channel":"performance-testing","difficulty":"intermediate","tags":["jmeter","k6","gatling","locust"]},{"id":"q-255","slug":"the-3am-pager-that-changed-everything-how-netflix-learned-to-stop-trusting-json","title":"The 3am Pager That Changed Everything: How Netflix Learned to Stop Trusting JSON","intro":"It was 3am when the pager went off. Again. Netflix's streaming service was buckling under a wave of malformed JSON payloads that were slipping through","channel":"security","difficulty":"intermediate","tags":["top10","asvs","samm"]},{"id":"q-346","slug":"the-night-10000-kubernetes-resources-almost-broke-production","title":"The Night 10,000 Kubernetes Resources Almost Broke Production","intro":"It was 3am when the pager went off. Our brand new Kubernetes operator, designed to manage a fleet of microservices, was consuming memory like a black ","channel":"kubernetes","difficulty":"advanced","tags":["crds","controllers","reconciliation"]},{"id":"q-466","slug":"the-midnight-mystery-why-your-linux-server-lies-about-memory","title":"The Midnight Mystery: Why Your Linux Server Lies About Memory","intro":"It was 3am when the pager went off. Production services were crashing, but `free -m` showed 8GB available RAM. I stared at the screen, confused. How c","channel":"linux","difficulty":"advanced","tags":["linux"]},{"id":"q-467","slug":"the-3am-pager-that-changed-everything-building-llm-services-that-dont-break","title":"The 3AM Pager That Changed Everything: Building LLM Services That Don't Break","intro":"It was 3:17 AM when the pager went off. Our 'unbreakable' LLM service was melting down, costing us $47,000 in unexpected GPU bills while users stared ","channel":"llm-ops","difficulty":"intermediate","tags":["llm-ops"]},{"id":"q-358","slug":"the-2m-mistake-when-linear-regression-almost-killed-a-startup","title":"The $2M Mistake: When Linear Regression Almost Killed a Startup","intro":"It was 2am when Sarah's Slack lit up. 'Churn prediction is broken,' read the message from their VP of Engineering. Their fancy new ML model was predic","channel":"machine-learning","difficulty":"beginner","tags":["regression","classification","clustering"]},{"id":"q-328","slug":"the-million-dollar-grid-how-netflix-solved-the-path-problem-that-saved-them-mill","title":"The Million-Dollar Grid: How Netflix Solved the Path Problem That Saved Them Millions","intro":"Ever had your API crash at 3am because your routing algorithm went haywire? Netflix faced exactly this nightmare when their content delivery network s","channel":"algorithms","difficulty":"intermediate","tags":["dp","memoization","tabulation"]},{"id":"q-464","slug":"the-collection-view-layout-whisperer-taming-dynamic-heights-like-a-boss","title":"The Collection View Layout Whisperer: Taming Dynamic Heights Like a Boss","intro":"Ever had your beautiful collection view layout crash at 3am because dynamic cell heights went haywire? You're not alone. Creating smooth-scrolling col","channel":"ios","difficulty":"intermediate","tags":["ios"]},{"id":"q-357","slug":"database-olympics-when-your-security-system-needs-to-drink-from-the-firehose","title":"Database Olympics: When Your Security System Needs to Drink from the Firehose","intro":"Ever had your API crash at 3am because your database couldn't handle the security event tsunami? We've all been there - watching monitoring graphs spi","channel":"aws","difficulty":"intermediate","tags":["rds","aurora","dynamodb","elasticache"]},{"id":"q-344","slug":"docker-diets-how-to-shrink-your-850mb-container-without-losing-your-mind","title":"Docker Diets: How to Shrink Your 850MB Container Without Losing Your Mind","intro":"Ever had your CI/CD pipeline fail at 3am because your Docker image hit the registry size limit? We've all been there - staring at that bloated 850MB c","channel":"devops","difficulty":"intermediate","tags":["dockerfile","compose","multi-stage"]},{"id":"sy-132","slug":"rate-limiting-roulette-how-to-win-at-1m-requests-without-crashing","title":"Rate Limiting Roulette: How to Win at 1M+ Requests Without Crashing","intro":"Ever had your API crash at 3am because a viral tweet sent 10x your normal traffic? We've all been there. Building a rate limiter that handles millions","channel":"system-design","difficulty":"advanced","tags":["api","rest"]},{"id":"sy-139","slug":"token-bucket-tango-dancing-with-100m-api-requests-without-breaking-a-sweat","title":"Token Bucket Tango - Dancing With 100M API Requests Without Breaking a Sweat","intro":"Ever had your API crash at 3am because a 'small' client decided to test your limits with 50K requests per second? We've all been there - staring at er","channel":"system-design","difficulty":"advanced","tags":["api","rest"]},{"id":"sd-2","slug":"the-ring-master-how-netflix-survives-the-midnight-cache-apocalypse","title":"The Ring Master: How Netflix Survives the Midnight Cache Apocalypse","intro":"Ever had your API crash at 3am because a single cache node went down and took 10% of your data with it? You're not alone. When your traffic suddenly s","channel":"system-design","difficulty":"advanced","tags":["hashing","dist-sys","caching"]},{"id":"q-313","slug":"building-slacks-brain-how-real-time-chat-survives-the-chaos","title":"Building Slack's Brain: How Real-Time Chat Survives the Chaos","intro":"Ever had your chat app go dark during a team crisis at 3am because messages started appearing out of order? That's when you realize building a distrib","channel":"system-design","difficulty":"advanced","tags":["dist-sys","cap-theorem","consensus"]},{"id":"sy-138","slug":"rate-limiting-like-a-boss-surviving-the-10m-request-apocalypse","title":"Rate Limiting Like a Boss: Surviving the 10M Request Apocalypse","intro":"Ever had your API crash at 3am because a viral tweet sent 10M requests your way? We've all been there - watching our beautiful architecture crumble un","channel":"system-design","difficulty":"advanced","tags":["api","rest"]},{"id":"q-260","slug":"selenium-grid-survival-guide-taming-the-10k-session-beast","title":"Selenium Grid Survival Guide - Taming the 10K Session Beast","intro":"Ever had your test suite crash at 3am because Selenium Grid decided to hoard memory like a dragon with gold? You're not alone. Building a grid that ha","channel":"system-design","difficulty":"advanced","tags":["selenium","webdriver","grid"]},{"id":"sy-158","slug":"mastering-distributed-rate-limiting-scaling-to-1m-requests-per-second","title":"Mastering Distributed Rate Limiting: Scaling to 1M Requests Per Second","intro":"In today's hyper-connected world, distributed systems must handle massive traffic loads while maintaining fairness and preventing abuse. Designing a r","channel":"system-design","difficulty":"advanced","tags":["dist-sys","architecture"]},{"id":"gh-103","slug":"mastering-self-healing-systems-in-distributed-architectures","title":"Mastering Self-Healing Systems in Distributed Architectures","intro":"In today's complex distributed systems, failures aren't just possible‚Äîthey're inevitable. Self-healing systems represent the pinnacle of operational e","channel":"system-design","difficulty":"advanced","tags":["advanced","cloud"]},{"id":"sy-141","slug":"mastering-real-time-collaboration-building-a-global-serverless-document-platform","title":"Mastering Real-Time Collaboration: Building a Global Serverless Document Platform","intro":"In today's hyper-connected world, teams expect seamless collaboration across continents with zero latency. Building a globally distributed document ed","channel":"system-design","difficulty":"advanced","tags":["infra","scale"]},{"id":"sy-144","slug":"mastering-distributed-rate-limiting-at-scale","title":"Mastering Distributed Rate Limiting at Scale","intro":"In today's hyper-connected world, protecting your services from overload while maintaining fair access is crucial. A robust distributed rate limiting ","channel":"system-design","difficulty":"advanced","tags":["dist-sys","architecture"]},{"id":"q-352","slug":"mastering-distributed-order-processing-with-saga-pattern-in-high-frequency-tradi","title":"Mastering Distributed Order Processing with Saga Pattern in High-Frequency Trading","intro":"In the world of high-frequency trading, where millions of transactions occur every second, system reliability isn't just important‚Äîit's everything. A ","channel":"system-design","difficulty":"advanced","tags":["saga","cqrs","event-sourcing"]},{"id":"q-213","slug":"mastering-multi-tier-caching-building-999-available-e-commerce-platforms","title":"Mastering Multi-Tier Caching: Building 99.9% Available E-Commerce Platforms","intro":"In today's hyper-competitive e-commerce landscape, every millisecond counts. A robust multi-tier caching strategy isn't just a performance optimizatio","channel":"system-design","difficulty":"advanced","tags":["cache","redis","memcached","cdn"]}];

function openSearch() {
  document.getElementById('searchModal').classList.add('active');
  document.getElementById('searchInput').focus();
  document.body.style.overflow = 'hidden';
}

function closeSearch() {
  document.getElementById('searchModal').classList.remove('active');
  document.body.style.overflow = '';
  document.getElementById('searchInput').value = '';
  document.getElementById('searchResults').innerHTML = '';
}

document.addEventListener('keydown', (e) => {
  if ((e.metaKey || e.ctrlKey) && e.key === 'k') {
    e.preventDefault();
    openSearch();
  }
  if (e.key === 'Escape') closeSearch();
});

document.getElementById('searchInput')?.addEventListener('input', (e) => {
  const query = e.target.value.toLowerCase().trim();
  const results = document.getElementById('searchResults');
  
  if (!query) {
    results.innerHTML = '';
    return;
  }
  
  const matches = searchData.filter(a => 
    a.title.toLowerCase().includes(query) ||
    a.intro.toLowerCase().includes(query) ||
    a.channel.toLowerCase().includes(query) ||
    a.tags.some(t => t.toLowerCase().includes(query))
  ).slice(0, 8);
  
  if (matches.length === 0) {
    results.innerHTML = '<div class="search-empty">No articles found</div>';
    return;
  }
  
  results.innerHTML = matches.map(a => {
    const highlight = (text) => text.replace(new RegExp('(' + query + ')', 'gi'), '<span class="search-highlight">$1</span>');
    return `<a href="/posts/${a.id}/${a.slug}/" class="search-result">
      <div class="search-result-title">${highlight(a.title)}</div>
      <div class="search-result-meta">
        <span class="tag">${a.channel.replace(/-/g, ' ')}</span>
        <span class="difficulty ${a.difficulty}">${a.difficulty}</span>
      </div>
      <div class="search-result-excerpt">${highlight(a.intro)}...</div>
    </a>`;
  }).join('');
});

// Enhanced table styling with color coding
document.querySelectorAll('.article-content table').forEach(table => {
  const rows = table.querySelectorAll('tbody tr');
  rows.forEach(row => {
    const cells = row.querySelectorAll('td');
    cells.forEach((cell, idx) => {
      const text = cell.textContent.trim().toLowerCase();
      // Positive indicators - green
      if (['‚úì', '‚úî', 'yes', 'true', 'high', 'fast', 'good', 'better', 'best', 'low latency', 'recommended'].some(p => text.includes(p))) {
        cell.style.color = '#10b981';
        cell.style.fontWeight = '500';
      }
      // Negative indicators - red/orange
      else if (['‚úó', '‚úò', 'no', 'false', 'slow', 'bad', 'worse', 'worst', 'high latency', 'not recommended', 'deprecated'].some(n => text.includes(n))) {
        cell.style.color = '#f87171';
        cell.style.fontWeight = '500';
      }
      // Neutral/medium indicators - yellow
      else if (['medium', 'moderate', 'partial', 'sometimes', 'depends', 'varies'].some(m => text.includes(m))) {
        cell.style.color = '#fbbf24';
      }
      // Numbers and metrics - cyan accent
      else if (/^[\d.,]+[%xms]*$/.test(text) || /^\d+[kmgb]?$/i.test(text)) {
        cell.style.color = '#00d4ff';
        cell.style.fontFamily = 'JetBrains Mono, monospace';
      }
    });
  });
});
</script>
</body></html>