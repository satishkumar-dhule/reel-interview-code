{
  "id": "sr-148",
  "question": "You're designing capacity planning for a microservices platform handling 100M requests/day with 3x traffic spikes during flash sales. Each service has different resource profiles: API gateway (CPU-bound, 2ms avg), user service (memory-bound, 50ms avg), payment service (I/O-bound, 200ms avg), and inventory service (database-bound, 100ms avg). Design a capacity planning strategy that accounts for cascading failures, auto-scaling lag (2-3 minutes), and maintains 99.9% availability during peak loads.",
  "answer": "Use predictive scaling with 40% headroom, circuit breakers, bulkhead isolation, and pre-warming strategies for known events.",
  "explanation": "## Capacity Planning Strategy\n\n### 1. **Baseline Capacity Analysis**\n- **Normal Load**: 100M requests/day = ~1,157 RPS average\n- **Peak Load**: 3x spike = ~3,471 RPS\n- **Service-specific bottlenecks**: Identify each service's limiting resource\n\n### 2. **Predictive Scaling Approach**\n```\nTarget Capacity = (Peak Load Ã— Safety Factor) + Headroom\nSafety Factor = 1.4 (40% buffer for auto-scaling lag)\nHeadroom = 20% for unexpected spikes\n```\n\n### 3. **Service-Specific Strategies**\n- **API Gateway**: Horizontal scaling with load balancing\n- **User Service**: Memory-optimized instances with connection pooling\n- **Payment Service**: Queue-based processing with circuit breakers\n- **Inventory Service**: Read replicas and caching layers\n\n### 4. **Resilience Patterns**\n- **Circuit Breakers**: Prevent cascading failures\n- **Bulkhead Isolation**: Separate resource pools per service\n- **Graceful Degradation**: Non-critical features fail first\n\n### 5. **Pre-emptive Scaling**\n- **Scheduled Scaling**: Pre-warm for known events\n- **Predictive Metrics**: Use historical data and ML models\n- **Multi-zone Distribution**: Spread load across availability zones\n\n### 6. **Monitoring & Alerting**\n- **Leading Indicators**: Queue depth, response times, error rates\n- **Capacity Metrics**: CPU, memory, network, disk utilization\n- **Business Metrics**: Revenue impact, user experience scores",
  "diagram": "graph TD\n    A[Load Balancer] --> B[API Gateway Cluster]\n    B --> C[User Service Pool]\n    B --> D[Payment Service Pool]\n    B --> E[Inventory Service Pool]\n    \n    C --> F[User DB Replicas]\n    D --> G[Payment Queue]\n    E --> H[Inventory Cache]\n    E --> I[Inventory DB]\n    \n    J[Predictive Scaler] --> K[Metrics Collector]\n    K --> L[Historical Data]\n    K --> M[Real-time Metrics]\n    \n    J --> N[Auto-scaling Groups]\n    N --> B\n    N --> C\n    N --> D\n    N --> E\n    \n    O[Circuit Breaker] --> B\n    O --> C\n    O --> D\n    O --> E\n    \n    P[Monitoring Dashboard] --> K\n    Q[Alerting System] --> K",
  "difficulty": "advanced",
  "tags": [
    "capacity",
    "scaling"
  ],
  "lastUpdated": "2025-12-12T10:15:33.442Z"
}