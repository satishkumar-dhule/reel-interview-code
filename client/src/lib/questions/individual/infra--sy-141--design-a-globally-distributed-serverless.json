{
  "id": "sy-141",
  "question": "Design a globally distributed serverless platform for real-time collaborative document editing with offline support and conflict resolution. How would you handle data consistency, versioning, and low-latency synchronization across AWS regions while maintaining sub-50ms response times?",
  "answer": "Use CRDTs for conflict resolution, WebSocket for real-time sync, edge locations for caching, DynamoDB Global Tables with multi-region replication.",
  "explanation": "## Architecture Overview\n\n### Data Model & Consistency\n- **CRDT-based Operational Transformation**: Each client tracks operations using Conflict-Free Replicated Data Types\n- **Document State Partitioning**: Split documents into chunks by section/paragraph for parallel processing\n- **Version Vectors**: Lamport timestamps for causality tracking across regions\n\n### Multi-Region Strategy\n- **Active-Active Regions**: Deploy Lambda functions in us-east-1, eu-west-1, ap-southeast-1\n- **DynamoDB Global Tables**: Multi-master replication with conflict-free write patterns\n- **CloudFront Edge Locations**: Cache hot documents with WebSocket support\n\n### Real-time Synchronization\n- **WebSocket Connections**: API Gateway with WebSocket protocol for bidirectional communication\n- **EventBridge**: Cross-region event propagation for coordination\n- **Local Caching**: ElastiCache Redis in each region for hot document state\n\n### Offline Support\n- **Service Worker**: IndexedDB for local storage and operation queuing\n- **Delta Synchronization**: Only transmit changes, not full document state\n- **Conflict Resolution**: CRDT automatically resolves merge conflicts when reconnecting\n\n### Performance Optimizations\n- **Edge Computing**: CloudFront Functions for document diff calculation at edge\n- **Connection Pooling**: WebSocket multiplexing to reduce connection overhead\n- **Smart Routing**: Route 53 latency-based routing to nearest region\n\n### Monitoring & Scaling\n- **Auto Scaling**: Lambda provisioned concurrency for predictable performance\n- **Real-time Metrics**: CloudWatch custom metrics for collaboration metrics\n- **Circuit Breakers**: Regional isolation to prevent cascade failures",
  "diagram": "graph TD\n    A[Client Browser] -->|WebSocket| B[CloudFront Edge]\n    B -->|WebSocket| C[API Gateway WebSocket]\n    C --> D[Lambda Auth]\n    C --> E[Lambda Router]\n    E --> F[Lambda Document Handler]\n    E --> G[Lambda Sync Handler]\n    F --> H[DynamoDB Global Table]\n    G --> I[EventBridge Bus]\n    I --> J[Cross-Region EventBridge]\n    J --> K[Other Region Lambda]\n    F --> L[ElastiCache Redis]\n    K --> M[DynamoDB Replica]\n    A --> N[Service Worker]\n    N --> O[IndexedDB Storage]\n    P[Route 53] -->|Latency Routing| B\n    Q[CloudWatch] -->|Metrics| E",
  "difficulty": "advanced",
  "tags": [
    "infra",
    "scale"
  ],
  "lastUpdated": "2025-12-12T09:38:09.154Z"
}