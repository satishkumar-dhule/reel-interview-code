{
  "answer": "Implement a blue-green migration with dual-agent strategy: run Puppet and Ansible in parallel using Ansible's `puppet_facts` module for compatibility, maintain Puppet as safety net during validation phase, then gradually cutover with automated rollback triggers.",
  "explanation": "## Migration Strategy\n\n**Phase 1: Discovery and Inventory**\n- Use `puppet resource --types` to catalog all managed resources\n- Export Puppet configurations to Ansible variables using `puppet facts --render-as json`\n- Create dependency mapping between modules and services\n\n**Phase 2: Parallel Execution**\n- Deploy Ansible agent alongside Puppet in read-only mode\n- Use `ansible-pull` for non-critical systems first\n- Implement configuration drift detection:\n```yaml\n- name: Compare Puppet vs Ansible states\n  shell: |\n    puppet config print --section=main > /tmp/puppet_config.txt\n    ansible-config dump --only-changed > /tmp/ansible_config.txt\n    diff /tmp/puppet_config.txt /tmp/ansible_config.txt\n  register: config_diff\n  failed_when: config_diff.rc > 1\n```\n\n**Phase 3: Gradual Cutover**\n- Disable Puppet on canary servers (5% of fleet)\n- Run Ansible playbooks with `--check` mode for dry-run validation\n- Monitor application health metrics using custom sensors\n\n**Phase 4: Rollback Protocol**\n- Automated rollback triggers:\n  - CPU usage > 80% for 5 minutes\n  - Service health check failures > 3 consecutive attempts\n  - Configuration drift detection alerts\n- Rollback procedure:\n```bash\n#!/bin/bash\n# emergency_rollback.sh\nsystemctl stop ansible-pull\nsystemctl start puppet\npuppet agent -t --environment production\nansible-playbook --tags rollback site.yml\n```\n- Git-based configuration backup with immediate restore capability\n- Rollback verification using idempotency testing across all environments"
}